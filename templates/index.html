{% extends "base.html" %}

<body>
<div class="wrapper">
    {% block content %}
        {% raw %}
            <!--主面板-->
            <div class="wrapper-main test-result-list">
                <div id="main" class="main" role="main">
                    <article class="repo-header">
                        <header class="name">
                            <div id="ember378"
                                 class="ember-view ember-tooltip-or-popover-target ember-tooltip-or-popover-element-attached-bottom ember-tooltip-or-popover-element-attached-center ember-tooltip-or-popover-target-attached-top ember-tooltip-or-popover-target-attached-center"
                                 aria-describedby="ember380" tabindex="0">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" alt="Public repository"
                                     class="icon public">
                                    <g fill="none" stroke="#9ea3a8" stroke-linecap="round" stroke-linejoin="round"
                                       stroke-miterlimit="10">
                                        <path d="M7.089 13.343h6.434L13.524 1H2.176v12.343H4.46M2.176 10.543h11.348"></path>
                                        <path d="M4.46 12.239v2.756l1.394-1.285 1.235 1.236v-2.707zM4.199 1v9.543M5.635 8.737h.63M5.635 6.782h.63M5.635 4.828h.63M5.635 2.873h.63"></path>
                                    </g>
                                </svg>


                            </div>
                            <h1 class="repo-title">
                                <a id="ember381" class="ember-view">[todo:Group]</a> / <a
                                    :href="'/project/'+pro_id" id="ember382" class="active ember-view">{{pro_id}}</a>
                            </h1>
                        </header>
                        <main class="repo-main">
                            <div class="repo-navigation">
                                <nav id="testtype_nav" class="qaadmin-nav ">
                                    <ul>
                                        <li id="tab_current" class="active">
                                            <a href="/intest-tech/qaadmin" id="ember386" class="active">
                                                Current
                                            </a></li>
                                        <li id="tab_branches">
                                            <a href="/intest-tech/qaadmin/branches" id="ember387"
                                               class="ember-view"> Branches
                                            </a></li>
                                        <li id="tab_builds">
                                            <a href="/intest-tech/qaadmin/builds" id="ember388" class="ember-view">
                                                Build History
                                            </a></li>
                                        <li id="tab_pull_requests">
                                            <a href="/intest-tech/qaadmin/pull_requests" id="ember389"
                                               class="ember-view"> Pull Requests
                                            </a></li>
                                        <li id="tab_build" class="">
                                            <svg viewBox="0 0 15 15" class="tab-arrow">
                                                <path fill="none" stroke="#9d9d9d"
                                                      d="M4.32.5l6.247 6.942L4.32 14.5"></path>
                                            </svg>
                                            <a href="/intest-tech/qaadmin/builds/431048533" id="ember390"
                                               class="ember-view"> Build #9
                                            </a></li>
                                        <li id="tab_job">
                                            <a href="/intest-tech/qaadmin/jobs/431048534" id="ember391"
                                               class="ember-view"> Job #9.1
                                            </a></li>
                                        <li id="tab_settings">
                                            <a href="/intest-tech/qaadmin/settings" id="ember392"
                                               class="ember-view"> Settings
                                            </a></li>
                                        <li id="tab_requests">
                                            <a href="/intest-tech/qaadmin/requests" id="ember393"
                                               class="ember-view"> Requests
                                            </a></li>
                                        <li id="tab_caches">
                                            <a href="/intest-tech/qaadmin/caches" id="ember394" class="ember-view">
                                                Caches
                                            </a></li>
                                    </ul>
                                </nav>
                                <nav id="ember395" class="option-button ember-view">
                                    <button class="option-display" title="Show more options" type="button">
                                        <span class="label-align">More options</span>
                                        <span class="option-tofu"><svg xmlns="http://www.w3.org/2000/svg"
                                                                       viewBox="-503.7 379.2 17 10"
                                                                       class="icon-tofu"><path
                                                d="M-487.3 380.4H-503c-.4 0-.6-.3-.6-.6s.3-.6.6-.6h15.7c.4 0 .6.3.6.6s-.3.6-.6.6zm0 4.4H-503c-.4 0-.6-.3-.6-.6s.3-.6.6-.6h15.7c.4 0 .6.3.6.6s-.3.6-.6.6zm0 4.4H-503c-.4 0-.6-.3-.6-.6s.3-.6.6-.6h15.7c.4 0 .6.3.6.6s-.3.6-.6.6z"></path></svg></span>
                                    </button>
                                    <ul class="option-dropdown">
                                        <li>
                                            <a href="/intest-tech/qaadmin/settings" id="ember396"
                                               class="ember-view">Settings</a>
                                        </li>
                                        <li>
                                            <a href="/intest-tech/qaadmin/requests" id="ember397"
                                               class="ember-view">Requests</a>
                                        </li>
                                        <li>
                                            <a href="/intest-tech/qaadmin/caches" id="ember398"
                                               class="ember-view">Caches</a>
                                        </li>
                                        <li>
                                            <button class="trigger-build-anchor" type="button" data-ember-action=""
                                                    data-ember-action-399="399">Trigger build
                                            </button>
                                        </li>
                                    </ul>
                                </nav>
                            </div>

                            <!--test record-->
                            <div class="test-result-list">
                                <li id="ember736" :class="'branch-row row-li '+item.status" v-for="item in list">
                                    <div class="two-line fade-out">
                                        <h2 class="row-item">
                                          <span :class="'label-align '+item.status">
                                          <i class="fas fa-check" style="font-size: 16px;" v-if="item.success"></i>
                                          <i class="fas fa-times" style="font-size: 16px; width: 16px; padding-left: 2px;" v-else></i>
                                          {{item.version}}</span>
                                        </h2>
                                      <div class="row-builds">
                                        <div class="row-item">
                                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" class="icon">
                                              <path class="st0" d="M11.553 11.153c0 .663.589 1.216 1.289 1.105.442-.074.811-.442.884-.884.111-.553-.221-1.032-.663-1.216-.258-.111-.405-.368-.405-.663v-3.26M.868 5.867C.647 5.867.5 4.117.5 4.117c0-.221.147-.442.332-.479l2.616-.958h3.193l7.491 1.032c.221.036.368.22.368.404 0 0-.184 1.75-.368 1.75L.868 5.867zm5.767 8.602V1.206c0-.221-1.161-.405-1.345-.442L3.816.506c-.184-.037-.369.11-.369.294v13.632h2.211l.977.037zm2.21 0H1.237h7.608z"></path>
                                          </svg>
                                        <span class="label-align">
                                            {{item.count}} builds
                                        </span>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="two-line fade-out">
                                      <div class="row-item">
                                        <div>
                                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" class="icon"><circle class="st0" cx="7.5" cy="7.5" r="7"></circle><path class="st1" d="M7.275 3.208V7.5L9.98 9.254"></path></svg>
                                          <time class="label-align" datetime="PT49S">{{item.duration}} sec</time>
                                        </div>

                                      <div class="row-item row-calendar">
                                        <div title="Finished September 21, 2018 17:56:00">
                                          <svg viewBox="0 0 15 15" class="icon"><path class="st0" d="M.861.5H14.22v14H.861zm13.252 4.061H1.182"></path><path class="st0" d="M4.639 7.913c.178-.166.475-.359.893-.359.734 0 2.093 1.164-.906 3.906h2.297m1.295-3.905h2.425s-1.4 1.693-1.4 3.906"></path></svg>
                                          <time class="label-align" datetime="2018-09-21T09:56:38Z">a day ago</time>
                                        </div>
                                      </div>
                                    </div></div>
                                    <!--pipeline result-->
                                    <div class="one-line ">
                                      <ul class="build-tiles">
                                          <li title="Build #9 passed" :class="item[p].success ? 'passed': 'failed'" v-for="p in pipeline" v-if="item[p]">
                                              <a :href="'/project/'+pro_id+'/job/'+item[p].id">
                                                  <span title="Job passed" aria-label="Job passed" class="status-icon icon passed">
                                                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 15" v-if="item[p].success">
                                                          <path d="M14.5 1.5L6.499 13.716.5 8.78"></path>
                                                      </svg>
                                                      <svg viewBox="0 0 15 15" v-else>
                                                          <path d="M.5.5l14 14m0-14l-14 14" fill="none" stroke="#9d9d9d" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10"></path>
                                                      </svg>
                                                  </span>
                                                  <span class="build-tile-number">{{p}}</span>
                                              </a>
                                          </li>
                                      </ul>
                                    </div>
                                </li>
                            </div>
                            <!--end test record-->

                        </main>
                    </article>
                </div>
            </div>
        {% endraw %}
    {% endblock %}

</div>
</body>

{% block sctipt %}

var test_list_app = new Vue({
    data: {
        pro_id: '{{ id }}' || 'gt-server',
        list: [],
        pipeline:['单元测试', '接口测试']
    },
    methods: {
        getResultList() {
            var vm = this, pro_id = vm.pro_id;
            $.get('/api/test-result/get-version?project=' + pro_id, function (res) {
                if (!res || !res.data) { return alert('异常') }
                res.data.map(x=>x.success?x.status="passed":x.status="errored")
                vm.list = res.data
                console.info(vm.list)
            })
        }
    },
    created: function () {
        this.getResultList()
    }
});
test_list_app.$mount('.test-result-list')

{% endblock %}
